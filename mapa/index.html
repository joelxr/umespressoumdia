---
layout: default
---
<div class="video-container">
    <div id='map' style="position:absolute; top:0; bottom:0; width:100%;"></div>
    <script>
mapboxgl.accessToken = 'pk.eyJ1Ijoiam9lbHhyIiwiYSI6ImNpcTI3b3l5MzAxM3ZmaW5uMDBnMjYxd2IifQ.8HAKtUOggFVWSy1OlDvx2Q';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v9',
    center: [-38.506421,-3.736842],
    zoom: 10
});

map.on('load', function () {
    map.addSource("coffees", {
        "type": "geojson",
        "data": {
            "type": "FeatureCollection",
            "features": [
            {% for post in site.posts %}
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [{{ post.location-long }}, {{ post.location-lat }} ]
                },
                "properties": {
                    "title": "{{ post.place }}"
                }
            },
            {% endfor %}
            ]
        },
        cluster: true,
        clusterMaxZoom: 20,
        clusterRadius: 50
    });

    map.addLayer({
        "id": "coffees",
        "type": "symbol",
        "source": "coffees",
        "layout": {
            "icon-image": "marker-15",
        }
    });


    var layers = [
        [150, '#f28cb1'],
        [20, '#f1f075'],
        [0, '#51bbd6']
    ];

        layers.forEach(function (layer, i) {
            map.addLayer({
                "id": "cluster-" + i,
                "type": "circle",
                "source": "coffees",
                "paint": {
                    "circle-color": layer[1],
                    "circle-radius": 18
                },
                "filter": i === 0 ?
                    [">=", "point_count", layer[0]] :
                    ["all",
                [">=", "point_count", layer[0]],
                ["<", "point_count", layers[i - 1][0]]]
            });
        });

        // Add a layer for the clusters' count labels
        map.addLayer({
            "id": "cluster-count",
            "type": "symbol",
            "source": "coffees",
            "layout": {
                "text-field": "{point_count}",
                "text-font": [
                    "DIN Offc Pro Medium",
                    "Arial Unicode MS Bold"
                ],
                "text-size": 12
            }
        });
});
    </script>
</div>
